<htmlform formUuid="55ee4b76-1985-456e-8536-0958e7056b6b" formName="Chronic Care Visit"
          formEncounterType="664bb896-977f-11e1-8993-905e29aff6c1" formVersion="1.0">

    <macros>
        height=PIH:5090
        weight=PIH:5089
        systolic=PIH:5085
        diastolic=PIH:5086
        serumGlucose=PIH:887
        bloodSugarTestType=PIH:6381
        fasting=PIH:6379
        nyhaClass=PIH:3139
        nyhaAnswers=PIH:3135,PIH:3136,PIH:3137,PIH:3138
        nyhaLabels=I,II,III,IV
        seizures=PIH:7924
        peakFlowMeasured=PIH:7925
        peakFlowPredicted=PIH:7926
        asthmaQuestion=PIH:8410
        asthmaAnswers=PIH:1905,PIH:8405,PIH:8406,PIH:8407,PIH:8408,PIH:8409
        asthmaLabels=Not asthma,Intermittent,Mild persistent,Moderate persistent,Severe persistent,Severe Uncontrolled
        ncdDx=PIH:3683
        ncdAnswers=PIH:5,PIH:903,PIH:155,PIH:3720,PIH:3468,PIH:5622
        ncdLabels=Asthma,Hypertension,Epilepsy,Diabetes,Heart Failure,Other
        hospitalized=PIH:1715
        ncdHospitalized=PIH:8411
        preferredStockOut=PIH:8412
        currentMedsQuestion=PIH:$currentMedsQuestion
        currentMedsAnswers=PIH:798,PIH:1240,PIH:1243,PIH:3182,PIH:3187,PIH:1242,PIH:250,PIH:3186,PIH:3183,PIH:254,PIH:238,PIH:273,PIH:920,PIH:8413,PIH:4052,PIH:4046,PIH:99,PIH:4061
        currentMedsLabels=Salbutamol inhaler,Beclomethasone inhaler,Hydrochlorothiazide,Captopril,Amlodipine,Enalapril,Nifedipine,Atenolol,Lisinopril,Propanolol,Phenobarbital,Phenytoin,Carbamazepine,Insulin,Metformin,Glibenclamide,Furosemide,Spironolactone
        medsChanged=PIH:2432
        no=1066
        yes=1065
        labelYes=Y
        labelNo=N
        nextAppt=PIH:5096
        highRisk=PIH:8398
        fullyCompleted=PIH:8082
        unknown=PIH:1067
        labelUnk=Unk
        comments=PIH:2922
        medSalbutabol=PIH:798
        medLabelSalbutabol=Salbutabol inhaler
        medBeclomethasone=PIH:1240
        medLabelBeclomethasone=Beclomethasone
        medHydrochlorothiazide=PIH:1243
        medLabelHydrochlorothiazide=Hydrochlorothiazide
        medCaptopril=PIH:3182
        medLabelCaptopril=Captopril
        medAmlodipine=PIH:3187
        medLabelAmlodipine=Amlodipine
        medEnalapril=PIH:1242
        medLabelEnalapril=Enalapril
        medNifedipine=PIH:250
        medLabelNifedipine=Nifedipine
        medAtenolol=PIH:3186
        medLabelAtenolol=Atenolol
        medLisinopril=PIH:3183
        medLabelLisinopril=Lisinopril
        medPropanolol=PIH:254
        medLabelPropanolol=Propanolol
        medPhenobarbital=PIH:238
        medLabelPhenobarbital=Phenobarbital
        medPhenytoin=PIH:273
        medLabelPhenytoin=Phenytoin
        medCarbamazepine=PIH:920
        medLabelCarbamazepine=Carbamazepine
        medInsulin=PIH:8413
        medLabelInsulin=Insulin
        medMetformin=PIH:4052
        medLabelMetformin=Metformin
        medGlibenclamide=PIH:4046
        medLabelGlibenclamide=Glibenclamide
        medFurosemide=PIH:99
        medLabelFurosemide=Furosemide
        medSpironolactone=PIH:4061
        medLabelSpironolactone=Spironolactone
    </macros>

    <!-- Flowsheet table view -->
    <ifMode mode="VIEW" include="true">

        <table class="visit-table data-entry-table">
            <thead class="visit-table-header">
                <tr>
                    <td>Visit Date</td>
                    <td>HT</td>
                    <td>WT</td>
                    <td>Blood<br/>Pressure</td>
                    <td>Fingerstick</td> 
                    <td>CHF NYHA<br/>Classification</td>
                    <td># of seizures</td>
                    <td>Peak Flow <br/>/ % of Predicted</td>
                    <td>Asthma<br/>Classification</td>
                    <td>Diagnosis</td>
                    <td>Hospitalized<br/>since last visit?</td>
                    <td>For NCD?</td>
                    <td>Preferred Treatment<br/>Out of stock?</td>
                    <td>Current Medications</td>
                    <td>Medications Changed?</td>
                    <td>Next Appt.</td>
                    <td>High Risk?</td>
                    <td>Visit fully<br/>completed?</td>
                    <td>Comment</td>                  
                </tr>
                <tr style="font-size:.7em;">
                    <td>cm</td>
                    <td>kg</td>
                    <td>mmHg</td>
                    <td>mg/dl</td>
                    <td></td>
                    <td></td>
                    <td>/month</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>

            </thead>
            <tbody class="visit-table-body">
                <tr class="visit-table-row">
                    <td class="nowrap visit-date">
                        <!-- Encounter Date -->
                        <encounterDate/>
                    </td>
                    <td>
                        <!-- Height -->
                        <obs conceptId="$height" id="heightEntered" />
                    </td>
                    <td>
                        <!-- Weight -->
                        <obs conceptId="$weight"/>
                    </td>

                    <td>
                        <!-- Blood Pressure -->
                        <obs conceptId="$systolic" /> / <obs conceptId="$diastolic" /> 
                    </td>

                    <!-- Fingerstick -->
                    <td>
                        <obs conceptId="$serumGlucose"/> <obs conceptId="$bloodSugarTestType" answerConceptId="$fasting" style="checkbox"/>
                    </td>
                    <td>
                        <!-- CHF NYHA Classification --> 
                        <obs conceptId="$nyhaClass" answerConceptIds="$nyhaAnswers" answerLabels="$nyhaLabels" style="radio"/>
                    </td>
                    <td>
                        <!-- # Seizures -->
                        <obs conceptId="$seizures"/>
                    </td>

                        <!-- Peak flow / percent predicted -->
                    <td><obs conceptId="$peakFlowMeasured"/> / <obs conceptId="$peakFlowPredicted"/></td>

                    <td>
                        <!-- Asthma class -->
                        <obs conceptId="$asthmaQuestion" answerConceptIds="$asthmaAnswers" answerLabels="$asthmaLabels"/>
                    </td>
                    <td>
                        <!-- Diagnosis -->
                        <obs conceptId="$ncdDx" answerConceptIds="$ncdAnswers" answerLabels="$ncdLabels" style="checkbox"/>
                    </td>
                    <td>
                        <!-- Hospitalized since last visit -->
                        <obs conceptId="$hospitalized" style="yes_no" yesLabel="$labelYes" noLabel="$labelNo" />
                    </td>
                    <td>
                        <!-- For NCD? -->
                        <obs conceptId="$ncdHospitalized" style="radio" answerConceptIds="$no,$yes" answerLabels="$labelNo,$labelYes" />
                    </td>
                    <td>
                        <!-- Preferred out of stock -->
                        <obs conceptId="$preferredStockOut" style="radio" answerConceptIds="$no,$yes" answerLabels="$labelNo,$labelYes" />
                    </td>
                    <td>
                        <!-- current meds -->
                        <obs conceptId="$currentMedsQuestion" answerConceptIds="$currentMedsAnswers" answerLabels="$currentMedsLabels" style="checkbox"/>
                    </td>    
                    <td>
                        <!-- meds changed? -->
                        <obs conceptId="$medsChanged" answerConceptIds="$no,$yes" answerLabels="$labelNo,$labelYes" style="radio"/>
                    </td>              
                    <td>
                        <!-- next appt -->
                        <obs conceptId="$nextAppt"/>
                    </td>
                    <td>
                        <!-- high risk --> 
                        <obs conceptId="$highRisk" answerConceptId="$yes" answerLabel="$labelYes"/>
                    </td>
                    <td>
                        <!-- fully completed --> 
                        <obs conceptId="$fullyCompleted" style="radio" answerConceptIds="$yes,$no,$unknown" answerLabels="$labelYes,$labelNo,$labelUnk"/>
                    </td>
                    <td>
                        <!-- comments --> 
                        <obs conceptId="$comments"/>
                    </td>                    
                </tr>
            </tbody>
        </table>

    </ifMode>

    <!-- Data entry view -->
    <ifMode mode="VIEW" include="false">

        <h4 style="font-style: italic;">
            <b>Epilepsy Card</b>
            <span style="padding-left:50px;">Version 1</span>

            <span style="padding-left:50px;">
                <b style="padding-right:10px;">NCD Reg no:</b>
                <b>
                    <lookup complexExpression="#foreach( $id in $patientIdentifiers.get(&quot;Chronic Care Number&quot;) ) $!id #end"/>
                </b>
            </span>
        </h4>

        <table class="visit-edit-table">
            <tr>
                <th>Visit Date</th>
                <td>
                    <encounterDate id="visitDate" size="20" default="today"/>
                </td>
            </tr>
            <tr>
                <th>Visit Location</th>
                <td>
                    <encounterLocation id="visitLocation"/>
                </td>
            </tr>
            <tr>
                <th>Provider</th>
                <td>
                    <encounterProvider default="16576"/>
                </td>
            </tr>
            <tr>
                <th>Height</th>
                <td class="focus-field">
                    <obs conceptId="$height" id="heightInput" showUnits="true"/>
                </td>
            </tr>
            <tr>
                <th>Weight</th>
                <td>
                    <obs conceptId="$weight"/>
                </td>
            </tr>
            <tr>
                <th>Blood Pressure</th>
                <td>
                    <obs conceptId="$systolic" /> / <obs conceptId="$diastolic" /> 
                </td>
            </tr>
            <tr>
                <th>Fingerstick (fasting)</th>
                <td>
                    <obs conceptId="$serumGlucose"/> <obs conceptId="$bloodSugarTestType" answerConceptId="$fasting" style="checkbox" answerLabel=""/>
                </td>
            </tr>
            <tr>
                <th>CHF NYHA Classification</th>
                <td>
                    <obs conceptId="$nyhaClass" answerConceptIds="$nyhaAnswers" answerLabels="$nyhaLabels" style="radio"/>
                </td>
            </tr>
            <tr>
                <th>Number of seizures<br/>in the last month</th>
                <td>
                    <obs conceptId="$seizures"/>
                </td>
            </tr>
            <tr>
                <th>Peak Flow (Percent of predicted)</th>
                <td>
                    <obs conceptId="$peakFlowMeasured"/> (<obs conceptId="$peakFlowPredicted"/>)
                </td>
            </tr>
            <tr>
                <th>Asthma Classification</th>
                <td>
                    <obs conceptId="$asthmaQuestion" answerConceptIds="$asthmaAnswers" answerLabels="$asthmaLabels"/>  
                </td>
            </tr>   

            <tr>
                <th>Diagnosis</th>
                <td>
                    <obs conceptId="$ncdDx" answerConceptIds="$ncdAnswers" answerLabels="$ncdLabels" style="checkbox"/>
                </td>
            </tr>                                  
            <tr>
                <th>Hospitalized since last visit?</th>
                <td>
                    <obs conceptId="$hospitalized" style="yes_no"/> 
                </td>
            </tr>   
            <tr>
                <th>For NCD?</th>
                <td>
                    <obs conceptId="$ncdHospitalized" style="radio"/> 
                </td>
            </tr>   
            <tr>
                <th>Preferred treatment out of stock?</th>
                <td>
                    <obs conceptId="$preferredStockOut" style="radio"/>
                </td>
            </tr> 
            <tr>
                <th>Asthma Medications</th>
                <td>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medSalbutabol" answerLabel="$medLabelSalbutabol" style="checkbox"/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medBeclomethasone" answerLabel="$medLabelBeclomethasone" style="checkbox"/>
                </td>
            </tr>   
            <tr>
                <th>Hypertension Medications</th>
                <td>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medHydrochlorothiazide" answerLabel="$medLabelHydrochlorothiazide" style="checkbox"/><br/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medCaptopril" answerLabel="$medLabelCaptopril" style="checkbox"/><br/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medAmlodipine" answerLabel="$medLabelAmlodipine" style="checkbox"/><br/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medEnalapril" answerLabel="$medLabelEnalapril" style="checkbox"/><br/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medNifedipine" answerLabel="$medLabelNifedipine" style="checkbox"/><br/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medAtenolol" answerLabel="$medLabelAtenolol" style="checkbox"/><br/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medLisinopril" answerLabel="$medLabelLisinopril" style="checkbox"/><br/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medPropanolol" answerLabel="$medLabelPropanolol" style="checkbox"/>
                </td>
            </tr>  
            <tr>
                <th>Epilepsy Medications</th>
                <td>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medPhenobarbital" answerLabel="$medLabelPhenobarbital" style="checkbox"/><br/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medPhenytoin" answerLabel="$medLabelPhenytoin" style="checkbox"/><br/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medCarbamazepine" answerLabel="$medLabelCarbamazepine" style="checkbox"/><br/>
                </td>
            </tr>  
            <tr>
                <th>Diabetes Medications</th>
                <td>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medInsulin" answerLabel="$medLabelInsulin" style="checkbox"/><br/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medMetformin" answerLabel="$medLabelMetformin" style="checkbox"/><br/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medGlibenclamide" answerLabel="$medLabelGlibenclamide" style="checkbox"/>
                </td>
            </tr>     
            <tr>
                <th>Heart Failure Medications</th>
                <td>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medFurosemide" answerLabel="$medLabelFurosemide" style="checkbox"/>
                    <obs conceptId="$currentMedsQuestion" answerConceptId="$medSpironolactone" answerLabel="$medLabelSpironolactone" style="checkbox"/>
                </td>
            </tr>                                   
            <tr>
                <th>Medications changed?</th>
                <td>
                    <obs conceptId="$medsChanged" answerConceptIds="$no,$yes" answerLabels="$labelNo,$labelYes" style="radio"/>
                </td>
            </tr>            
            <tr>
                <th>Next appointment</th>
                <td>
                    <obs conceptId="$nextAppt" id="appointmentDate" allowFutureDates="true"/>
                </td>
            </tr>
            <tr>
                <th>Visit fully completed?</th>
                <td>
                    <obs conceptId="$fullyCompleted" style="radio" answerConceptIds="$yes,$no,$unknown"/>
                </td>
            </tr>            
            <tr>
                <th>Comment (if not fully completed)</th>
                <td>
                    <obs conceptId="$comments"/>
                </td>
            </tr>     
        </table>

        <submit/>

    </ifMode>

</htmlform>