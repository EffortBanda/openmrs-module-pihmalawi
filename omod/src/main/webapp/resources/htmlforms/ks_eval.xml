<htmlform formUuid="b5368dfc-2695-102d-b4c2-001d929acb54"
          formName="KS Evaluation Form"
          formEncounterType="664b8b8c-977f-11e1-8993-905e29aff6c1"
          formVersion="1">
          
    <macros>
        weight=PIH Malawi:5089
        height=PIH Malawi:5090
        bsa=PIH Malawi:3649
        bmi=PIH Malawi:2137
        diagnosis=PIH Malawi:3596
        clinical=PIH Malawi:3592
        biopsy=PIH Malawi:3593
        results=PIH Malawi:3597
        evalPeriod=PIH Malawi:3648
        onARVs=PIH Malawi:1622
        reasonARVs=PIH Malawi:1251
        hivDxDate=PIH Malawi:2515
        cd4AtDx=PIH Malawi:5497
        arvs=PIH Malawi:2538
        worsening=PIH Malawi:3599
        historyOI=PIH Malawi:3600
        ableWork=PIH Malawi:2064
        ableEat=PIH Malawi:3602
        ableWalk=PIH Malawi:3601
        cough=PIH Malawi:3650
        pain=PIH Malawi:3604
        labExams=PIH Malawi:1337
        cd4Lab=PIH Malawi:5497
        wbcLab=PIH Malawi:678
        ancLab=PIH Malawi:1022
        tlcLab=PIH Malawi:1021
        hgbLab=PIH Malawi:21
        pltLab=PIH Malawi:729
        sgotLab=PIH Malawi:653
        sgptLab=PIH Malawi:654
        stoolLab=PIH Malawi:3612
        cxrLab=PIH Malawi:1342
        lesions=PIH Malawi:3605
        ksFindings=PIH Malawi:3610
        findOralLesions=PIH Malawi:3606
        findViscLoc=PIH Malawi:3607
        findOedema=PIH Malawi:460
        findUlc=PIH Malawi:3608
        findLymph=PIH Malawi:161
        locations=PIH Malawi:3358
        class=PIH Malawi:3615
        tsAtPres=PIH Malawi:3621
        startDate=PIH Malawi:2516
    </macros>

    <!-- Flowsheet table view -->
    <ifMode mode="VIEW" include="true">

        <table class="visit-table data-entry-table">
            <thead class="visit-table-header">
               <tr>
                    <td>Visit Date</td>
                    <td>Weight</td>
                    <td>Height</td>
                    <td>BSA</td>
                    <td>BMI</td>
                    <td>Diagnosis</td>
                    <td>Evaluation<br/>Period</td>
                    <td>Patient <br/>on ARVs</td>
                    <td>Date of<br/> HIV Dx</td>
                    <td>CD4 at<br/> HIV Dx</td>
                    <td>ARV Regimen</td>
                    <td>Worsening KS <br/> Sx on ARV</td>
                    <td>History <br/>of OI's</td>
                    <td>Patient able to work<br/>or do daily activities</td>
                    <td>Patient able to<br/>eat (oral lesions)</td>
                    <td>Patient able<br/>to walk</td>
                    <td>Patient<br/>c/o cough</td>
                    <td>Pain (0-10)</td>
                    <td>Most recent CD4</td>
                    <td>WBC [/uL]</td>
                    <td>ANC [%]</td>
                    <td>TLC [%]</td>
                    <td>HGB [/dL]</td>
                    <td>PLT [/ul]</td>
                    <td>SGOT (AST) [/L]</td>
                    <td>SGPT (AST) [/L]</td>
                    <td>Stool Guaic Occult</td>
                    <td>CXR (Comments)</td>
                    <td>Number <br/>of Lesions</td>
                    <td>Oral<br/>Lesions</td>
                    <td>Visceral<br/>localizations</td>
                    <td>Oedema</td>
                    <td>Ulcerations</td>
                    <td>Lymphadenopathy</td>
                    <td>Location</td>
                    <td>Classification<br/>TS at present</td>
                    <td>HAART <br/>Start Date</td>
                </tr>
            </thead>
            <tbody class="visit-table-body">
                <tr class="visit-table-row">
                    <!-- Encounter Date -->
                    <td class="nowrap visit-date">
                        <encounterDate />
                    </td>
                    <!-- Weight -->
                    <td><obs conceptId="$weight" /></td>
                    <!-- Height -->
                    <td><obs conceptId="$height" /></td>
                    <!-- BSA -->
                    <td><obs conceptId="$bsa" /></td>
                    <!-- BMI -->
                    <td><obs conceptId="$bmi" /></td>
                    <!-- Diagnosis -->
                    <td>
                        <obs conceptId="$diagnosis" answerConceptId="$clinical" answerLabel="Clinical"
                    style="checkbox" />
                        <obs conceptId="$diagnosis" answerConceptId="$biopsy" answerLabel="Biopsy proven"
                    style="checkbox" />
                        <obs conceptId="$diagnosis" answerConceptId="$results" answerLabel="Results" />
                    </td>
                    <!-- Evaluation Period -->
                    <td><obs conceptId="$evalPeriod" /></td>
                    <!-- On ARVs -->
                    <td>
                        <obs conceptId="$onARVs"  style="yes_no"/>
                        <obs conceptId="$reasonARVs" />
                    </td>
                    <!-- Date of HIV dx -->
                    <td><obs conceptId="$hivDxDate" /></td>
                    <!-- CD4 at HIV dx -->
                    <td><obs conceptId="$cd4AtDx" showDate="true" /></td>
                    <!-- ARV regimen -->
                    <td><obs conceptId="$arvs" /></td>
                    <!-- Worsening KS Sx on ARV? -->
                    <td><obs conceptId="$worsening" style="yes_no" /></td>
                    <!-- History of OI's? -->
                    <td><obs conceptId="$historyOI" style="yes_no" /></td>
                    <!-- Patient able to work or do daily activities: -->
                    <td><obs conceptId="$ableWork" style="yes_no" /></td>
                    <!-- Patient able to eat (oral lesions): -->
                    <td><obs conceptId="$ableEat" style="yes_no" /></td>
                    <!-- Patient able to walk: -->
                    <td><obs conceptId="$ableWalk" style="yes_no" /></td>
                    <!-- Patient c/o cough: -->
                    <td><obs conceptId="$cough" style="yes_no" /></td>
                    <!-- Pain (0-10) -->
                    <td><obs conceptId="$pain" /></td>
                    <obsgroup groupingConceptId="$labExams">
                        <repeat>
                            <template>
                                    <td><obs conceptId="{conceptId}" showDate="{date}" style="radio" /></td>
                            </template>
                            <render conceptId="$cd4Lab" label="Most recent CD4 and date"
                                date="true" />
                            <render conceptId="$wbcLab" date="false"  />
                            <render conceptId="$ancLab" date="false"  />
                            <render conceptId="$tlcLab" date="false"  />
                            <render conceptId="$hgbLab" date="false"  />
                            <render conceptId="$pltLab" date="false" />
                            <render conceptId="$sgotLab" date="false"
                                answer="/L" />
                            <render conceptId="$sgptLab" date="false" />
                            <render conceptId="$stoolLab" date="false" />
                            <render conceptId="$cxrLab" date="false" />
                        </repeat>
                    </obsgroup>
                    <!-- Number of Lesions -->
                    <td><obs conceptId="$lesions" /></td>
                        <repeat>
                            <template>
                                <td><obs conceptId="$ksFindings" answerConceptId="{conceptId}" labelText="" style="yes_no" /></td>
                            </template>
                                <!-- oral lesions, visceral localizations, oedema, ulcerations, lymphadenopathy -->
                            <render conceptId="$findOralLesions" />
                            <render conceptId="$findViscLoc"  />
                            <render conceptId="$findOedema"  />
                            <render conceptId="$findUlc" />
                            <render conceptId="$findLymph"  />
                        </repeat>
                    <!-- Location -->
                    <td><obs conceptId="$locations" /></td>
                    <!-- Classification TS at present -->
                    <td><obs conceptId="$class" /><obs conceptId="$tsAtPres" /></td>
                    <!-- HAART -->
                    <td><obs conceptId="$startDate" /></td>
                </tr>
            </tbody>
            </table>
    </ifMode>

    <!-- Data entry view -->
    <ifMode mode="VIEW" include="false">

        <h4 style="font-style: italic;">
            <b>KS Evaluation Form</b>
            <span style="padding-left:50px;">Version 1</span>

            <span style="padding-left:50px;">
                <b style="padding-right:10px;">KS Reg no: </b>
                <b>
                    <lookup complexExpression="#foreach( $id in $patientIdentifiers.get(&quot;KS Number&quot;) ) $!id #end" />
                </b>
            </span>
        </h4>


        <table class="visit-edit-table">
            <tr>
                <th>Provider</th>
                <td><encounterProvider /></td>
            </tr>
            <tr>
                <th>Visit Location</th>
                <td><encounterLocation id="visitLocation"/></td>  
            </tr>
            <tr>
                <th>Visit Date</th>
                <td><encounterDate /></td>
            </tr>
            <tr>
                <td spancol="2"><hr/></td>
            </tr>
            <tr>
                <th>Weight</th>
                <td><obs conceptId="$weight" /></td>
            </tr>
            <tr>
                <th>Height</th>
                <td><obs conceptId="$height" /></td>
            </tr>
            <tr>
                <th>BSA</th>
                <td><obs conceptId="$bsa" /></td>
            </tr>
            <tr>
                <th>BMI</th>
                <td><obs conceptId="$bmi" /></td>
            </tr>
            <tr>
                <th>Diagnosis</th>
                <td>
                    <obs conceptId="$diagnosis" answerConceptId="$clinical" answerLabel="Clinical"
                style="checkbox" />
                    <obs conceptId="$diagnosis" answerConceptId="$biopsy" answerLabel="Biopsy proven"
                style="checkbox" />
                    <obs conceptId="$diagnosis" answerConceptId="$results" answerLabel="results:" />
                </td>
            </tr>
            <tr>
                <th>Evaluation<br/>Period</th>
                <td><obs conceptId="$evalPeriod" /></td>
            </tr>
            <tr>
                <th>Patient <br/>on ARVs</th>
                <td><obs conceptId="$onARVs" style="yes_no" /><br/>
                <obs conceptId="$reasonARVs" /></td>
            </tr>
            <tr>
                <th>Date of<br/> HIV Dx</th>
                <td><obs conceptId="$hivDxDate" /></td>
            </tr>
            <tr>
                <th>CD4 at<br/> HIV Dx</th>
                <td><obs conceptId="$cd4AtDx" showDate="true" /></td>
            </tr>
            <tr>
                <th>ARV Regimen</th>
                <td><obs conceptId="$arvs" /></td>
            </tr>
            <tr>
                <th>Worsening KS <br/> Sx on ARV</th>
                <td><obs conceptId="$worsening" style="yes_no" /></td>
            </tr>
            <tr>
                <th>History <br/>of OI's</th>
                <td><obs conceptId="$historyOI" style="yes_no" /></td>
            </tr>
            <tr>
                <th>Patient able to work<br/>or do daily activities</th>
                <td><obs conceptId="$ableWork" style="yes_no" /></td>
            </tr>
            <tr>
                <th>Patient able to<br/>eat (oral lesions)</th>
                <td><obs conceptId="$ableEat" style="yes_no" /></td>
            </tr>
            <tr>
                <th>Patient able<br/>to walk</th>
                <td><obs conceptId="$ableWalk" style="yes_no" /></td>
            </tr>
            <tr>
                <th>Patient<br/>c/o cough</th>
                <td><obs conceptId="$cough" style="yes_no" /></td>
            </tr>
            <tr>
                <th>Pain (0-10)</th>
                <td><obs conceptId="$pain" /></td>
            </tr>
            <tr>
                <th colspan="2"><h3>Laboratory</h3></th>
            </tr>
                <obsgroup groupingConceptId="$labExams">
                    <repeat>
                        <template>
                            <tr>
                                <th>{label}</th>
                                <td><obs conceptId="{conceptId}" showDate="{date}"
                                style="radio" /> {answer}</td>
                            </tr>
                        </template>
                        <render conceptId="$cd4Lab" label="Most recent CD4 and date"
                            date="true" answer="" />
                        <render conceptId="$wbcLab" label="WBC" date="false" answer="[/uL]" />
                        <render conceptId="$ancLab" label="ANC" date="false" answer="[%]" />
                        <render conceptId="$tlcLab" label="TLC" date="false" answer="[%]" />
                        <render conceptId="$hgbLab" label="HGB" date="false" answer="/[dL]" />
                        <render conceptId="$pltLab" label="PLT" date="false" answer="[/ul]" />
                        <render conceptId="$sgotLab" label="SGOT (AST)" date="false"
                            answer="[/L]" />
                        <render conceptId="$sgptLab" label="SGPT (ALT)" date="false"
                            answer="[/L]" />
                        <render conceptId="$stoolLab" label="Stool Guaic Occult" date="false"
                            answer="" />
                        <render conceptId="$cxrLab" label="CXR (Comments)" date="false"
                            answer="" />
                    </repeat>
                </obsgroup>
            <tr>
                <th colspan="2"><h3>Clinical Examination</h3></th>
            </tr>                
            <tr>
                <th>Number <br/>of Lesions</th>
                <td><obs conceptId="$lesions" /></td>
            </tr>
            <repeat>
                <template>
                    <tr>
                        <th>{label}</th><td><obs conceptId="$ksFindings" answerConceptId="{conceptId}"  style="yes_no" /></td>
                    </tr>
                </template>
                    <!-- oral lesions, visceral localizations, oedema, ulcerations, lymphadenopathy -->
                <render conceptId="$findOralLesions" label="Oral lesions:" />
                <render conceptId="$findViscLoc" label="Visceral localizations:" />
                <render conceptId="$findOedema" label="Oedema:" />
                <render conceptId="$findUlc" label="Ulcerations:" />
                <render conceptId="$findLymph" label="Lymphadenopathy:" />
            </repeat>
            <tr>
                <th>Location</th>
                <td><obs conceptId="$locations" /></td>
            </tr>
            <tr>
                <th>Classification<br/>TS at present</th>
                <td><obs conceptId="$class" /><obs conceptId="$tsAtPres" /></td>
            </tr>
            <tr>
                <th>HAART <br/>Start Date</th>
                <td><obs conceptId="$startDate" /></td>
            </tr>
               
        </table>

        <submit/>

    </ifMode>

</htmlform>