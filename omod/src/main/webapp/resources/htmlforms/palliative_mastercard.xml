<htmlform formUuid="e0822500-955d-11e7-abc4-cec278b6b50a"
          formName="Palliative Care Mastercard"
          formEncounterType="e0822140-955d-11e7-abc4-cec278b6b50a"
          formVersion="1.2">

    <style type="text/css">
            form input[type="checkbox"], form input[type="radio"], .form input[type="checkbox"], .form input[type="radio"] {
                float: none;
                display: inline-block;
            }

            form label, .form label {
                display: inline-block;
            }
    </style>

    <macros>
        diagnosisDate=6774
        pcDiagnosisSet=9848aec4-e681-11e7-80c1-9a214cf093ae
        palliativeCareDiagnosis=9848b126-e681-11e7-80c1-9a214cf093ae

        cancerDx=7211
        depressionDx=207
        diabetesDx=3720
        hypertensionDx=903
        heartFailureDx=3468
        hfStages=3139
        nyha1=3135
        nyha2=3136
        nyha3=3137
        nyha4=3138
        chronicLungDx=155569AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
        mentalHealthDx=7f55864c-e68d-11e7-80c1-9a214cf093ae
        epilepsyDx=155
        kidneyFailureDx=3681
        tuberculosis=58

        diabetesFamilyHistory=6740
        hypertensionFamilyHistory=8458
        asthmaFamilyHistory=8426
        epilepsyFamilyHistory=8484
        allergyFamilyHistory=151530AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
        tbContactFamilyHistory=13491200-e5bd-11e7-80c1-9a214cf093ae

        insightText=9848b694-e681-11e7-80c1-9a214cf093ae
        familyInfoText=9848b9aa-e681-11e7-80c1-9a214cf093ae
        numMales=725B3C83-CCE5-4A71-A7F1-CB1565D6F7ED
        numFemales=155FE093-4A8A-4A23-899E-A435B45A7D05
        numChildren=2649

        other=5622
        yesAnswer=1065
        noAnswer=1066
        unknown=1067
        hivStatus=3753
        hivTestDate=1837
        reactive=1228
        nReactive=1229
        artStartDate=2516
        tbStatus=7459
        smearPos=2185
        smearNeg=2186
        eptb=1547
        tbYear=8453
        patientPhone=1426
        guardianName=1824
        guardianPhone=2616
        relationToPatient=1328
        agreesToFollowup=2552
        chwName=8431
        married=1055

        <macro key="religion" value="162929AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
        <macro key="historyConstruct" value="9168ACDB-F4CC-49A3-91D9-77E767EEFE78"/>
        <macro key="historyGivenBy" value="B71C09E6-F03E-4BBE-AC89-EF2B236397F3"/>
        <macro key="historyByPatient" value="1249F550-FF24-4F3E-A743-B37232E9E1C3"/>
        <macro key="historyByGuardian" value="65668f5a-977f-11e1-8993-905e29aff6c1"/>
        <macro key="symptomSet" value="A69F0C71-69A5-4783-BC1A-7C2B70C46E02"/>
        <macro key="shortnessOfBreath" value="656ea87a-977f-11e1-8993-905e29aff6c1"/>
        <macro key="peripheralNeuropathy" value="6572996c-977f-11e1-8993-905e29aff6c1"/>
        <macro key="coughing" value="65460a32-977f-11e1-8993-905e29aff6c1"/>
        <macro key="fatigue" value="656e9c9a-977f-11e1-8993-905e29aff6c1"/>
        <macro key="nauseaVomit" value="133473AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
        <macro key="constipation" value="655aa366-977f-11e1-8993-905e29aff6c1"/>
        <macro key="diarrhea" value="6545a61e-977f-11e1-8993-905e29aff6c1"/>
        <macro key="anorexia" value="654a83e6-977f-11e1-8993-905e29aff6c1"/>
        <macro key="dysphagia" value="654a9246-977f-11e1-8993-905e29aff6c1"/>
        <macro key="vaginalBleeding" value="147232AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
        <macro key="bleeding" value="6572103c-977f-11e1-8993-905e29aff6c1"/>
        <macro key="dryMouth" value="156095AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
        <macro key="symptomDate" value="65732bf2-977f-11e1-8993-905e29aff6c1"/>

        <macro key="baselinePainConstructA" value="E2D13414-6D37-4468-9719-DA6126F74FDE"/>
        <macro key="baselinePainConstructB" value="E60A40E0-B954-4251-86AD-10E875E7FFDB"/>
        <macro key="painLocation" value="94C1A0B9-5F44-422F-A468-9434BDA06D01"/>

        <macro key="painDuration" value="08C78D58-3841-4CF5-A2EE-CE8F13CB0901"/>
        <macro key="painScore" value="6566c524-977f-11e1-8993-905e29aff6c1"/>
        <macro key="affectingSleep" value="6A47512F-E573-4074-9000-24F6C93A5EB2"/>

    </macros>

    <style>
        .nowrap {
            white-space: nowrap;
        }
    </style>

    <span style="display:none">
        <encounterProvider default="16576"/>
        <span id="patientBirthdate">
            <lookup expression="patient.birthdate"/>
        </span>
    </span> <!-- Set provider to a default as not used -->

    <div>
        <h4 style="font-style: italic;">
            <b>Palliative Care Patient Card</b>
            (Green Card)
            <span style="padding-left:50px;">Version 1</span>

            <span style="padding-left:50px;">
                <b style="padding-right:10px;">
                    <encounterLocation id="mastercardLocation"/>
                    <span style="padding-left:20px;">
                        Date
                        <encounterDate/>
                    </span>
                </b>
            </span>

            <span style="padding-left:50px;">
                <b style="padding-right:10px;">PC Reg no</b>
                <b>
                    <lookup complexExpression="#foreach( $id in $patientIdentifiers.get(&quot;Palliative Care Number&quot;) ) $!id #end"/>
                </b>
            </span>
        </h4>

        <table class="data-entry-table">
            <tr style="border: none;">
                <td style="vertical-align:top;" >
                    <h4>Patient / Guardian Details</h4>
                    <table>
                        <tr>
                            <td>Patient Name</td>
                            <td>
                                <lookup expression="patient.personName"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Sex, DOB</td>
                            <td>
                                <span class="left-cell">
                                    <lookup expression="patient.gender"/>
                                </span>
                                <span class="right-cell">
                                    <lookup expression="patient.birthdate"/>
                                    (Age:<lookup expression="patient.age"/>)
                                </span>
                            </td>
                        </tr>
                        <tr>
                            <td>Physical Address</td>
                            <td>
                                <lookup complexExpression="#foreach( $addr in $patient.addresses) $!addr.getAddress1() $!addr.getCityVillage() $!addr.getStateProvince() $!addr.getCountyDistrict(), #end"/>
                            </td>
                        </tr>

                        <tr>
                            <td>Patient Phone</td>
                            <td>
                                <obs conceptId="$patientPhone" size="10"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Religion</td>
                            <td>
                                <obs conceptId="$religion" />
                            </td>
                        </tr>
                        <tr>
                            <td>Guardian Name</td>
                            <td>
                                <obs id="guardianNameField" conceptId="$guardianName" />
                            </td>
                        </tr>
                        <tr>
                            <td>Guardian Phone</td>
                            <td>
                                <obs conceptId="$guardianPhone" size="10"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Guardian relation to patient</td>
                            <td>
                                <obs conceptId="$relationToPatient" size="10"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Agrees to FUP</td>
                            <td>
                                <obs conceptId="$agreesToFollowup" style="radio" answerLabels="N,Y"
                                     answerConceptIds="$noAnswer,$yesAnswer"/>
                            </td>
                        </tr>
                        <tr>
                            <td>CHW Name</td>
                            <td>
                                <obs conceptId="$chwName"/>
                            </td>
                        </tr>
                        <tr>
                            <td>CBO/HBC</td>
                            <td>
                                <!--ToDo:  What is CBO/HBC? -->
                            </td>
                        </tr>
                    </table>
                </td>

                <td style="vertical-align:top;">
                    <h4>Patient Overview</h4>

                    <table>
                        <tr>
                            <th style="vertical-align:top;" align="left" colspan="2">
                                Diagnoses
                            </th>
                        </tr>

                        <tr>
                            <!-- ToDo: Add Cancer stage and types -->
                            <obsgroup groupingConceptId="$pcDiagnosisSet">
                                <td data-toggle-source="cancer-dx" data-toggle-target="cancer-dx-date">
                                    <obs id="cancer-dx" conceptId="$palliativeCareDiagnosis" style="checkbox"
                                         answerConceptId="$cancerDx" answerLabel="Cancer"/>
                                </td>
                                <td>
                                    <obs id="cancer-dx-date" conceptId="$diagnosisDate" labelText="Date"/>
                                </td>
                            </obsgroup>
                        </tr>


                        <repeat with="['$depressionDx','Depression'],
                                  ['$diabetesDx','Diabetes'],
                                  ['$hypertensionDx','Hypertension']">

                            <tr>
                                <obsgroup groupingConceptId="$pcDiagnosisSet">
                                    <td data-toggle-source="{1}-dx" data-toggle-target="{1}-dx-date">
                                        <obs id="{1}-dx" conceptId="$palliativeCareDiagnosis" style="checkbox"
                                             answerConceptId="{0}" answerLabel="{1}"/>
                                    </td>
                                    <td>
                                        <obs id="{1}-dx-date" conceptId="$diagnosisDate" labelText="Date"/>
                                    </td>
                                </obsgroup>
                            </tr>
                        </repeat>

                        <tr>
                            <!-- Heart failure -->
                            <obsgroup groupingConceptId="$pcDiagnosisSet">
                                <td data-toggle-source="hf-dx" data-toggle-target="hf-dx-date">
                                    <obs id="hf-dx" conceptId="$palliativeCareDiagnosis" style="checkbox"
                                         answerConceptId="$heartFailureDx" answerLabel="Heart Failure"/>
                                    <br/>
                                    <obs conceptId="$hfStages"
                                         answerConceptIds="$nyha1,$nyha2,$nyha3,$nyha4"
                                         answerLabels="I,II,III,IV"
                                         labelText="Stage:"
                                    />
                                </td>
                                <td>
                                    <obs id="hf-dx-date" conceptId="$diagnosisDate" labelText="Date"/>
                                </td>
                            </obsgroup>
                        </tr>

                        <repeat with="['$chronicLungDx','chronicLung', 'Chronic Lung Disease'],
                                  ['$mentalHealthDx','mental','Mental Health'],
                                  ['$epilepsyDx','epilepsy','Epilepsy'],
                                  ['$kidneyFailureDx','kidney','Kidney Failure']">

                            <tr>
                                <obsgroup groupingConceptId="$pcDiagnosisSet">
                                    <td data-toggle-source="{1}-dx" data-toggle-target="{1}-dx-date">
                                        <obs id="{1}-dx" conceptId="$palliativeCareDiagnosis" style="checkbox"
                                             answerConceptId="{0}" answerLabel="{2}"/>
                                    </td>
                                    <td>
                                        <obs id="{1}-dx-date" conceptId="$diagnosisDate" labelText="Date"/>
                                    </td>
                                </obsgroup>
                            </tr>
                        </repeat>


                        <tr>
                            <!-- Other dx -->
                            <obsgroup groupingConceptId="$pcDiagnosisSet">
                                <td class="nowrap" data-toggle-source="other-dx" data-toggle-target="other-dx-date">
                                    <obs id="other-dx" conceptId="$palliativeCareDiagnosis" style="checkbox"
                                         answerConceptId="$other" answerLabel="Other" commentFieldLabel=""/>
                                </td>
                                <td class="nowrap">
                                    <obs id="other-dx-date" conceptId="$diagnosisDate" labelText="Date"/>
                                </td>
                            </obsgroup>
                        </tr>

                        <tr>
                            <td>
                                <obs conceptId="$hivStatus" labelText="HIV"
                                     answerConceptIds="$reactive,$nReactive,$unknown"/>
                                <br/>
                                <obs conceptId="$hivTestDate" labelText="Date test"/>
                            </td>
                            <td>
                                <obs conceptId="$artStartDate" labelText="ART Start Date"/>
                            </td>
                        </tr>
                        <tr>
                            <td class="nowrap">
                                <obsgroup groupingConceptId="$pcDiagnosisSet">
                                    <obs conceptId="$palliativeCareDiagnosis" style="checkbox"
                                        answerConceptId="$tuberculosis" answerLabel="TB:" />
                                </obsgroup>

                                <obs conceptId="$tbStatus"
                                     answerConceptIds="$smearPos,$smearNeg,$eptb,$unknown"
                                     answerLabels="smear pos,smear neg,EPTB,never had TB"/>
                            </td>
                            <td>
                                <obs conceptId="$tbYear" labelText="Year"/>
                            </td>
                        </tr>
                    </table>
                </td>
                <td style="vertical-align:top;">
                    <h4>Patient History / Main presenting symptoms</h4>
                    <table>
                        <tr>
                            <td colspan="2">
                                <b>History given by</b>
                                <br/>
                                <obs conceptId="$historyGivenBy" answerConceptId="$historyByPatient" answerLabel="Patient" />&amp;nbsp;
                                <obs conceptId="$historyGivenBy" answerConceptId="$historyByGuardian" answerLabel="Guardian" />
                            </td>
                        </tr>
                        <repeat with="['$shortnessOfBreath','sob', 'Shortness of breath'],
                                  ['$peripheralNeuropathy','pn','Peripheral neuropathy'],
                                  ['$vaginalBleeding','pvBleeding','Bleeding (PV)'],
                                  ['$bleeding','otherBleeding','Bleeding (other)'],
                                  ['$coughing','cough', 'Coughing'],
                                  ['$fatigue','fatigue', 'Fatigue'],
                                  ['$nauseaVomit','nausea', 'Nausea/Vomiting'],
                                  ['$constipation','constip', 'Constipation'],
                                  ['$diarrhea','diarrhea', 'Diarrhoea'],
                                  ['$dryMouth','dryMouth', 'Dry mouth'],
                                  ['$anorexia','anorexia', 'Anorexia'],
                                  ['$dysphagia','dysphagia', 'Dysphagia']">

                            <tr>
                                <obsgroup groupingConceptId="$historyConstruct">
                                    <td data-toggle-source="{1}-his" data-toggle-target="{1}-his-date">
                                        <obs id="{1}-his" conceptId="$symptomSet" style="checkbox"
                                             answerConceptId="{0}" answerLabel="{2}"/>
                                    </td>
                                    <td>
                                        <obs id="{1}-his-date" conceptId="$symptomDate" labelText="Date"/>
                                    </td>
                                </obsgroup>
                            </tr>
                        </repeat>

                        <tr>
                            <obsgroup groupingConceptId="$historyConstruct">
                                <td data-toggle-source="other-his" data-toggle-target="other-his-date">
                                    <obs id="other-his" conceptId="$symptomSet" style="checkbox"
                                         answerConceptId="$other" answerLabel="Other" commentFieldLabel="" />
                                </td>
                                <td>
                                    <obs id="other-his-date" conceptId="$symptomDate" labelText="Date"/>
                                </td>
                            </obsgroup>
                        </tr>

                    </table>

                </td>

                <td style="vertical-align:top;">
                    <h4>Baseline Pain Rating</h4>
                    <table>
                        <thead class="visit-table-header">
                            <tr>
                                <td>Description</td>
                                <td>A</td>
                                <td>B</td>
                                <td>C</td>
                                <td>D</td>
                            </tr>
                        </thead>
                        <tbody class="visit-table-body">
                            <tr class="visit-table-row">
                                <td style="text-align: left;">Location</td>
                                <repeat with="['$baselinePainConstructA','baselinePainConstructA','A'],
                                      ['$baselinePainConstructB','baselinePainConstructB','B']">
                                    <td style="padding: 1px;" >
                                        <obsgroup groupingConceptId="{0}">
                                            <span class="nowrap">
                                                <obs conceptId="$painLocation" />
                                            </span>
                                        </obsgroup>
                                    </td>
                                </repeat>
                                <td colspan="2">C and D</td>
                            </tr>
                            <tr class="visit-table-row">
                                <td style="text-align: left;">Duration</td>
                                <repeat with="['$baselinePainConstructA','baselinePainConstructA','A'],
                                      ['$baselinePainConstructB','baselinePainConstructB','B']">
                                    <td style="padding: 1px;" >
                                        <obsgroup groupingConceptId="{0}">
                                            <span class="nowrap">
                                                <obs conceptId="$painDuration" />
                                            </span>
                                        </obsgroup>
                                    </td>
                                </repeat>
                                <td colspan="2">C and D</td>
                            </tr>
                            <tr class="visit-table-row">
                                <td style="text-align: left;">Severity<br></br>0-5</td>
                                <repeat with="['$baselinePainConstructA','baselinePainConstructA','A'],
                                      ['$baselinePainConstructB','baselinePainConstructB','B']">
                                    <td style="padding: 1px;" >
                                        <obsgroup groupingConceptId="{0}">
                                            <span class="nowrap">
                                                <obs conceptId="$painScore" />
                                            </span>
                                        </obsgroup>
                                    </td>
                                </repeat>
                                <td colspan="2">C and D</td>
                            </tr>
                            <tr class="visit-table-row">
                                <td style="text-align: left;">Affecting sleep? </td>
                                <repeat with="['$baselinePainConstructA','baselinePainConstructA','A'],
                                      ['$baselinePainConstructB','baselinePainConstructB','B']">
                                    <td style="padding: 1px;" >
                                        <obsgroup groupingConceptId="{0}">
                                            <span class="nowrap">
                                                <obs conceptId="$affectingSleep" answerConceptIds="$yesAnswer,$noAnswer" answerLabels="Y,N" style="radio" />
                                            </span>
                                        </obsgroup>
                                    </td>
                                </repeat>
                                <td colspan="2">C and D</td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
        </table>


        <table>
            <tr>
                <td>
                    Currently have spouse?
                    <br/>
                    <obs conceptId="$married" style="yes_no"/>
                </td>

                <td rowspan="2">
                    <b>Patients and family insight</b>
                    (diagnosis, treatment and prognosis)
                    <br/>
                    <obs conceptId="$insightText" rows="2" cols="50" />
                </td>

                <td rowspan="3">
                    <table>
                        <tr>
                            <th colspan="2" align="left">Family history</th>
                        </tr>

                        <repeat with="['$hypertensionFamilyHistory','HTN'],
                                      ['$diabetesFamilyHistory','Diabetes'],
                                      ['$asthmaFamilyHistory','Asthma'],
                                      ['$allergyFamilyHistory','Allergies'],
                                      ['$epilepsyFamilyHistory','Epilepsy'],
                                      ['$tbContactFamilyHistory','TB Contact']">

                            <tr>
                                <td>{1}</td>
                                <td>
                                    <obs conceptId="{0}" style="radio"
                                    answerLabels="Yes,No,Unknown"
                                    answerConceptIds="$yesAnswer,$noAnswer,$unknown"/>
                                </td>
                            </tr>
                        </repeat>
                    </table>
                </td>
            </tr>

            <tr>
                <td>Number of children in the family:
                    <obs conceptId="$numChildren"/>
                </td>
            </tr>

            <tr>
                <td>Family Tree structure:
                    <br/>
                    <span style="padding-left:50px;"></span>
                    <obs conceptId="$numMales"/>=male
                    <br/>
                    <span style="padding-left:50px;"></span>
                    <obs conceptId="$numFemales"/>=female
                </td>

                <td>
                    <b>Other important family members/information</b><br/>
                    (Explore Ages of children, Level of education or currently attending school and what grade)
                    <br/>
                    <obs conceptId="$familyInfoText" rows="2" cols="50"/>
                </td>
            </tr>

            <tr>
                <td colspan="3">
                    <b>
                        Outcome:
                        <lookup expression="fn.currentProgramWorkflowStatus(24).state.concept.name"/>
                        (<lookup expression="fn.currentProgramWorkflowStatus(24).startDate"/>)
                    </b>
                </td>
            </tr>
        </table>

        <ifMode mode="VIEW" include="false">
            <div id="buttons" style="margin-top:10px;">
                <button class="submitButton confirm" onclick="submitHtmlForm()">
                    <uimessage code="uicommons.save"/>
                    <i class="icon-spinner icon-spin icon-2x" style="display: none; margin-left: 10px;"></i>
                </button>
            </div>
        </ifMode>
    </div>
</htmlform>