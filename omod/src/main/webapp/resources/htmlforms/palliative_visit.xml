<htmlform formUuid="03c5f102-9d08-11e7-abc4-cec278b6b50a"
          formName="Palliative Care Visit"
          formEncounterType="e082235c-955d-11e7-abc4-cec278b6b50a"
          formVersion="1.0">

    <macros>
        <macro key="height" value="5090"/>
        <macro key="weight" value="5089"/>
        <macro key="noAnswer" value="1066"/>
        <macro key="yesAnswer" value="1065"/>
        <macro key="systolicBP" value="5085"/>
        <macro key="diastolicBP" value="5086"/>

        <macro key="locationOfVisit" value="1F5A206E-9E08-4CDA-BC83-3B1DB492F3C5"/>
        <macro key="homeLocation" value="29EB5E06-9815-42D8-A3B1-37A5FE88B4F8"/>
        <macro key="ic3Location" value="3064BCF8-56F7-43C9-A8CF-D90D42EEF739"/>
        <macro key="hospitalWardLocation" value="20B8B0FB-F0D7-4692-96BF-5B516CA0D624"/>
        <macro key="functionalStatus" value="61EB2A1C-3DB0-4453-8E89-6FBD09563A96"/>
        <macro key="pc_no_support" value="C745EF20-19A1-4E43-998D-E34658580828"/>
        <macro key="pc_needs" value="1FD42AA9-AA92-48FB-AD9C-C985CA7FD8F1"/>
        <macro key="pc_bed_ridden" value="4C6822BE-88EA-4E71-A7EC-4D3E7403B3D5"/>

        <macro key="patientOnLaxative" value="2D452120-1DC7-427F-89FC-7FEE85A1E709"/>

        <macro key="painScore" value="6566c524-977f-11e1-8993-905e29aff6c1"/>

        <macro key="counseling" value="480E00E5-D428-45F1-B819-413FE5FAEAC0"/>

        hospitalSinceLast=1715
        drugsNow=1193
        drugSet=8501
        clinicalImpression=1364
        nextAppt=5096
    </macros>

    <style>
        .atab {
            display: inline-block;
            width: 150px;
        }
    </style>

    <!-- Flowsheet table view -->
    <ifMode mode="VIEW" include="true">

        <table class="visit-table data-entry-table">
            <thead class="visit-table-header">
                <tr>
                    <td>Visit Date</td>
                    <td>Ht</td>
                    <td>Wt</td>
                    <td>BP</td>
                    <td colspan="3">Location<br/>of visit</td>
                    <td colspan="3">Functional status</td>
                    <td rowspan="2" span="2">Patient on laxative?</td>
                    <td colspan="2">Referral</td>
                    <td rowspan="2" style="font-size:.7em;">Hospitalization since last visit</td>
                    <td colspan="2">Chemotheraphy<br/>and Bleomycin</td>
                    <td rowspan="2">Pain<br/>score</td>

                    <td rowspan="2">Counseling</td>
                    <td rowspan="2">Management Plan<br/>Comments</td>
                    <td rowspan="2">Next appt</td>
                </tr>
                <tr>
                    <td><i style="font-size:.7em;">day/month/year</i></td>
                    <td><i>cm</i></td>
                    <td><i>kg</i></td>
                    <td><span style="font-size:.7em;">SBP/DBP</span></td>
                    <td class="rotate"><span style="font-size:.7em;">Home</span></td>
                    <td class="rotate"><span style="font-size:.7em;">IC3</span></td>
                    <td class="rotate"><span style="font-size:.7em;">Hospital ward</span></td>
                    <td class="rotate"><span style="font-size:.7em;">No support</span></td>
                    <td class="rotate"><span style="font-size:.7em;">Needs</span></td>
                    <td class="rotate"><span style="font-size:.7em;">Bed ridden</span></td>
                    <td class="rotate"><span style="font-size:.7em;">POSER Referral</span></td>
                    <td class="rotate"><span style="font-size:.7em;">QECH Referral</span></td>
                </tr>
            </thead>
            <tbody class="visit-table-body">
                <tr class="visit-table-row">
                    <td class="nowrap visit-date">
                        <!-- Encounter Date -->
                        <encounterDate />
                    </td>
                    <td>
                        <!-- Height -->
                        <obs conceptId="$height" id="heightEntered" />
                    </td>
                    <td>
                        <!-- Weight -->
                        <obs conceptId="$weight" />
                    </td>

                    <td>
                        <!-- Blood pressure -->
                        <obs conceptId="$systolicBP" />/<obs conceptId="$diastolicBP" />
                    </td>

                    <!-- Location of Visit -->
                    <repeat with="['$homeLocation'],['$ic3Location'],['$hospitalWardLocation']">
                        <td>
                            <obs conceptId="$locationOfVisit" answerConceptId="{0}" answerLabel=""/>
                        </td>
                    </repeat>

                    <!-- Functional Status -->
                    <repeat with="['$pc_no_support'],['$pc_needs'],['$pc_bed_ridden']">
                        <td>
                            <obs conceptId="$functionalStatus" answerConceptId="{0}" answerLabel=""/>
                        </td>
                    </repeat>

                    <td>
                        <!-- Patient on laxative -->
                        <obs conceptId="$patientOnLaxative" answerConceptIds="$yesAnswer,$noAnswer" answerLabels="Y,N" style="radio" />
                    </td>
                    <td>
                        <!-- Referral -->
                        Referral#1
                    </td>
                    <td>
                        <!-- Referral -->
                        Referral#2
                    </td>

                    <td>
                        <!-- Hospitalized since last visit -->
                        <obs conceptId="$hospitalSinceLast" style="yes_no" yesLabel="Y" noLabel="N" />
                    </td>

                    <td colspan="2">
                        <!-- Chemo --> chemo
                    </td>

                    <td>
                        <!-- Pain score  -->
                        <obs conceptId="$painScore" />
                    </td>

                    <td>
                        <!-- Counseling -->
                        <obs conceptId="$counseling" answerConceptIds="$yesAnswer,$noAnswer" answerLabels="Y,N" style="radio" />
                    </td>

                    <td>
                        <!-- Management plan / comments -->
                        Management plan
                    </td>

                    <td>
                        <!-- Next appointment -->
                        <obs conceptId="$nextAppt" />
                    </td>
                </tr>
            </tbody>
        </table>

    </ifMode>

    <!-- Data entry view -->
    <ifMode mode="VIEW" include="false">

        <h4 style="font-style: italic;">
            <b>Hypertension and Diabetes Patient Card</b>
            <span style="padding-left:50px;">Version 1</span>

            <span style="padding-left:50px;">
                <b style="padding-right:10px;">NCD Reg no: </b>
                <b>
                    <lookup complexExpression="#foreach( $id in $patientIdentifiers.get(&quot;Chronic Care Number&quot;) ) $!id #end" />
                </b>
            </span>
        </h4>

        <span style="display:none"><encounterProvider default="16576" /></span> <!-- Set provider to a default as not used -->

        <table class="visit-edit-table">
            <tr>
                <th>Visit Date</th>
                <td><encounterDate id="visitDate" size="20" default="today" /></td>
            </tr>
            <tr>
                <th>Visit Location</th>
                <td><encounterLocation id="visitLocation" /></td>
            </tr>
            <tr class="focus-field">
                <th>Height</th>
                <td class="focus-field"><obs conceptId="$height" id="heightInput" showUnits="true" /></td>
            </tr>
            <tr>
                <th>Weight</th>
                <td><obs conceptId="$weight" id="weightInput" showUnits="true" /></td>
            </tr>

            <tr>
                <th>Blood pressure</th>
                <td><obs conceptId="$systolicBP" />/<obs conceptId="$diastolicBP" /></td>
            </tr>

            <tr>
                <th>Location of visit</th>
                <td>
                    <repeat with="['$homeLocation','Home'],['$ic3Location','IC3'],['$hospitalWardLocation','Hospital ward']">
                        <obs conceptId="$locationOfVisit" answerConceptId="{0}" answerLabel="{1}"/>
                    </repeat>
                </td>
            </tr>

            <tr>
                <th>Functional status</th>
                <td>
                    <repeat with="['$pc_no_support','No support'],['$pc_needs','Needs'],['$pc_bed_ridden','Bed ridden']">
                        <obs conceptId="$functionalStatus" answerConceptId="{0}" answerLabel="{1}"/>
                    </repeat>
                </td>
            </tr>

            <tr>
                <!-- Patient on laxative -->
                <th>Patient on laxative?</th>
                <td><obs conceptId="$patientOnLaxative" answerConceptIds="$yesAnswer,$noAnswer" style="radio" /> </td>
            </tr>

            <tr>
                <th>Referral</th>
                <td style="text-align: left">
                </td>
            </tr>

            <tr>
                <th>Hospitalized since last visit?</th>
                <td>
                    <obs conceptId="$hospitalSinceLast" style="yes_no" />
                </td>
            </tr>

            <tr>
                <th>Chemo...</th>
                <td></td>
            </tr>

            <tr>
                <th>Pain score(0-5)</th>
                <td><obs conceptId="$painScore" id="painScore" /></td>
            </tr>


            <tr>
                <th>Treatment details</th>
                <td></td>
            </tr>

            <tr>
                <!-- Counseling -->
                <th>Counseling?</th>
                <td><obs conceptId="$counseling" answerConceptIds="$yesAnswer,$noAnswer" style="radio" /> </td>
            </tr>

            <tr>
                <th>Management plan</th>
                <td>
                </td>
            </tr>

            <tr>
                <th>Next appointment<br/></th>
                <td><obs conceptId="$nextAppt" id="appointmentDate" allowFutureDates="true" /></td>
            </tr>

        </table>

        <submit/>

    </ifMode>

</htmlform>